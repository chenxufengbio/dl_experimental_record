## 实验流程概述

1.利用变异信息（vcf）里的变异信息（SNP)来替换水稻参考基因组中原本序列，生成品种基因型；

2.参考deepsea中定义组蛋白修饰标签的方式，将基因组切分成每500bp一个bin，根据narrowPeak文件里的信号区域范围，使用slide window的方式，在每个peak的最高点中心取一定长度的区域，与slide window重合超过10%就标记为有组蛋白修饰（标签为1），否则为无修饰（标签为0），注意每个品种的组蛋白修饰情况不同，最终形成训练集。20个水稻品种序列信息 ：组蛋白修饰标签（五个二分类）；

3.将训练集投入深度学习模型，进行调参，选择最优模型参数；

4.利用神经网络的提取特征的特性将PWM矩阵从卷积层中提取出来，获取高保守性的序列motif，与JASPAR数据库中的TFBS进行对比；

5.利用训练好的模型进行预测，绘制组蛋白修饰定性图谱。

```text
/public/home/xwli/xwzhang/deeplearningDATA/rice

├── data/
├── mapto_MSU7/
├── MHZS_mapto_MHRS1_ZSRS1/
│   
├── pytorch_deepsea/ 
├── DeepHistone/
├── Nt_Transformer/
└── scripts/
│   ├── py_scripts/
│   └── sh_scripts/
    
```

### 技术路线

![img](https://img.imgdb.cn/item/60925c34d1a9ae528fb18774.png)

